---

layout: post
title:  "프론트, 백엔드를 어떻게 나눠서 개발할 수 있나?"
date:   2018-10-31 18:00
author: Larry Jung
categories: ETC

---

# 어떻게 할 수 있을까요?  

**내가 해 왔던 방식**  

1. 스프링부트 프로젝트를 생성한다.  
2. RestController에다가 api서버를 만든다.   
3. 프로젝트 내부에 있는 resource디렉토리에 index.html을 비롯하여 필요한 자바스크립트 코드를 만든다.  
4. 서버를 계속 띄워보면서 ( localhost:8080 ) 브라우저를 켜 접속하여 변경사항을 수정한다. 매우 불편한 단계.  

5. 일단 개발 완료!  
6. - AWS EC2에 우분투를 설치하고 거기에 scp를 이용하여 프로젝트를 복사한 후에 `java -jar`   로 실행  
   - 배포 스크립트를 만들어서 로컬에서 푸쉬하면 EC2 우분투에서 프로젝트를 빌드하여 배포  

7. 동일 EC2 우분투 인스턴스에 nginx를 설치한 후, entrypoint를 :80으로만 허용하면서 동적 요청은 :8080인 WAS로 재할당하게 프록시 설정을 한다.  



위 방식으로 개발하게 되면 (나 밖에 없겠지ㅠ), 

-  깃헙 저장소가 하나 뿐이다. 저장소의 코드 언어 비율을 보면 자바 프로젝트임에도 불구하고 자바스크립트 비율이 어마어마하게 나온다..  
- 프론트, 백엔드 나뉘어 지지 않았다.  
- 모든 프로젝트는 api서버가 개발 완료 된 후에야 프론트엔드 개발을 시작하는 단계일 수 밖에 없다.  



실은 입사 전 공부하면서 궁금해 하던 것이긴 했는데, 프로젝트도 혼자 해본 경험밖에 없었고 깊게 생각하지 못했다. 이번 기회에 어떻게 프론트 개발과 백엔드 개발을 분리할 수 있는지? 고려해야 할 상황에 대해서 정리를 해 나가려고 한다.  



***이하 작성하는 모든 것에 대해서 틀린 정보가 있을 수 있습니다. 확인되지 않는 개인의 생각도 무성합니다. 현재 정리하는 시점은 거의 사고실험 수준입니다..***   



백엔드 개발이야 일단 하면 된다. 로컬에서 개발을 하면 주로 8080포트로 띄우게 되고, 로컬서버를 띄운 것이므로 로컬에서 요청을 날리면 문제 없이 반응한다.  

**문제는 프론트엔드 개발이다.**  

몇 가지 경우를 생각해 볼 수 있다.  

1. 백엔드 프로젝트가 100% 구현되어 EC2에 고유 도메인을 가지고 (예를 들어 https://www.larry.com ) 있을 때   
2. 백엔드 프로젝트가 하나도 구현되어 있지 않은 상황에서 당장 프론트엔드 프로젝트를 동시에 시작해야 할 때   
3. 백엔드 프로젝트가 50% 정도 구현되어 있지만 개발자의 로컬에서만 돌아가는 상태  
4. 백엔드 프로젝트가 50% 정도 구현되어 있고 중간 중간 단계마다 EC2에 올라가 있는 상태  
5. 풀스택 개발자가 로컬에 백엔드 프로젝트를 띄워논 후에 프론트엔드 프로젝트를 시작하려는 상태   



**1번** - 백엔드 프로젝트가 100% 구현되어 EC2에 고유 도메인을 가지고 (예를 들어 https://www.larry.com ) 있을 때     

- 저장소를 따로 만들 수 있다.   
- ajax요청에 대해서 EC2 도메인으로 리소스 요청을 할 수 있으나, 크로스 오리진 정책에 걸려 브라우저가 요청을 허용하지 않는다. 자바스크립트 표준 정책에 의하면 js에서 ajax요청을 보낼 때 동일 출처(프로토콜, 호스트명, 포트)가 아니면 브라우저에서 요청을 날리지 않는 것을 말한다.   
- 프론트엔드 개발을 하기 위해 번들러로 로컬에서 개발 서버를 띄운 후에(`localhost:1234`) EC2에 있는 `www.larry.com/users/1` 에 요청을 하는 순간 내 로컬에 있는 크롬브라우저가 자바스크립트 실행 엔진 표준에 의거하여 요청을 날리는 것을 거부한다는 것이다.   
- 이 때 해결할 수 있는 방법은 [여기](https://brunch.co.kr/@adrenalinee31/1)에 잘 설명되어 있다. 정리하면   
  1. 브라우저에서 그냥 요청을 보내도록 강제 설정을 해 주던지  
  2.  서버를 통제할 수 있다면 서버에서 크로스 오리진 도메인에 대한 요청에 대해 허용해 줄 수 있다.   스프링의 어노테이션이나 서블릿 필터 등을 사용하면 된다.  
- 일단 프론트엔드 개발 완료!   
- 프론트엔드 개발을 완료하고 번들링 후에 결과물을 어디에 배포해야할까?   
- 새로운 EC2 인스턴스를 만든다.   
- nginx를 설치하고 nginx에 번들링 결과물을 scp로 복사해 넣는다. 혹은 ci툴을 이용하여 배포한다.    
- nginx에 프록시를 설정하여 api서버로 전달되게 한다.   



위 과정 중에 사실 배포 하는 프로세스가 정확히 어떤 것인지, 경험해 보지 않았기 때문에 잘 모르겠으나 일단 포스트가 수정될 여지가 있음을 남기고 1차 정리를 해본다.   

[다른 참고](https://steemit.com/font-end/@caesium133/21-1)  



